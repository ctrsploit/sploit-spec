package vulnerability

import "github.com/ctrsploit/sploit-spec/pkg/prerequisite"

type ExistsStruct struct {
	VulnerabilityExists bool
	prerequisite.BasePrerequisite
}

func (p *ExistsStruct) Check() (bool, error) {
	return p.CheckTemplate(func() (bool, error) {
		p.Satisfied = p.VulnerabilityExists
		return p.Satisfied, p.Err
	})
}

func Exists(vulnerabilityExists bool) *ExistsStruct {
	return &ExistsStruct{
		VulnerabilityExists: vulnerabilityExists,
		BasePrerequisite: prerequisite.BasePrerequisite{
			Name:      "Vulnerability Exists",
			Info:      "",
			Satisfied: false,
		},
	}
}
