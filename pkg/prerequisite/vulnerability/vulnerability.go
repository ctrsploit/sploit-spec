package vulnerability

import "github.com/ctrsploit/sploit-spec/pkg/prerequisite"

type ExistsStruct struct {
	VulnerabilityExists bool
	prerequisite.BasePrerequisite
}

func (p *ExistsStruct) Check() (satisfied bool, err error) {
	if !p.Checked {
		p.Satisfied = p.VulnerabilityExists
		p.Checked = true
	}
	satisfied = p.Satisfied
	return
}

func Exists(vulnerabilityExists bool) *ExistsStruct {
	return &ExistsStruct{
		VulnerabilityExists: vulnerabilityExists,
		BasePrerequisite: prerequisite.BasePrerequisite{
			Name:      "Vulnerability Exists",
			Info:      "",
			Satisfied: false,
		},
	}
}
